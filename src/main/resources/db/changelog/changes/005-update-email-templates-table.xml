<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

    <changeSet id="005-add-email-template-columns" author="openmailer">
        <!-- Add template type -->
        <addColumn tableName="email_templates">
            <column name="template_type" type="VARCHAR(50)" defaultValue="CUSTOM"/>
        </addColumn>

        <!-- Add HTML flag -->
        <addColumn tableName="email_templates">
            <column name="is_html" type="BOOLEAN" defaultValueBoolean="true"/>
        </addColumn>

        <!-- Add version control -->
        <addColumn tableName="email_templates">
            <column name="version" type="INT" defaultValueNumeric="1"/>
        </addColumn>

        <!-- Add active status -->
        <addColumn tableName="email_templates">
            <column name="is_active" type="BOOLEAN" defaultValueBoolean="true"/>
        </addColumn>

        <!-- Add preview text -->
        <addColumn tableName="email_templates">
            <column name="preview_text" type="VARCHAR(255)"/>
        </addColumn>

        <!-- Create index on template type -->
        <createIndex indexName="idx_email_templates_type" tableName="email_templates">
            <column name="template_type"/>
        </createIndex>

        <createIndex indexName="idx_email_templates_active" tableName="email_templates">
            <column name="is_active"/>
        </createIndex>
    </changeSet>

</databaseChangeLog>
